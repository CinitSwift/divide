<!--é¦–é¡µ-->
<view class="container">
  <!-- ç”¨æˆ·ä¿¡æ¯ -->
  <view class="user-card card">
    <image class="avatar avatar-large" src="{{userInfo.avatarUrl || '/images/default-avatar.png'}}" mode="aspectFill"></image>
    <view class="user-info">
      <text class="nickname">{{userInfo.nickname || 'æ¸¸å®¢ç”¨æˆ·'}}</text>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-section">
    <view class="action-card card" bindtap="goCreateRoom">
      <view class="action-icon">ğŸ¯</view>
      <view class="action-content">
        <text class="action-title">åˆ›å»ºæˆ¿é—´</text>
        <text class="action-desc">åˆ›å»ºæ–°æˆ¿é—´ï¼Œé‚€è¯·å¥½å‹åŠ å…¥</text>
      </view>
      <view class="action-arrow">â€º</view>
    </view>

    <view class="action-card card" bindtap="showJoinDialog">
      <view class="action-icon">ğŸšª</view>
      <view class="action-content">
        <text class="action-title">åŠ å…¥æˆ¿é—´</text>
        <text class="action-desc">è¾“å…¥æˆ¿é—´å·åŠ å…¥å·²æœ‰æˆ¿é—´</text>
      </view>
      <view class="action-arrow">â€º</view>
    </view>
  </view>

  <!-- æˆ‘åˆ›å»ºçš„æˆ¿é—´ -->
  <view class="my-room-section" wx:if="{{myRoom}}">
    <view class="section-title">æˆ‘åˆ›å»ºçš„æˆ¿é—´</view>
    <view class="room-card card" bindtap="goMyRoom">
      <view class="room-header">
        <text class="room-name">{{myRoom.gameName}}</text>
        <text class="room-code">æˆ¿é—´å·: {{myRoom.roomCode}}</text>
      </view>
      <view class="room-info">
        <text class="member-count">{{myRoom.memberCount}}/{{myRoom.maxMembers}} äºº</text>
        <view class="room-status status-{{myRoom.status}}">{{myRoom.status === 'waiting' ? 'ç­‰å¾…ä¸­' : myRoom.status === 'divided' ? 'å·²åˆ†è¾¹' : 'å·²å…³é—­'}}</view>
      </view>
    </view>
  </view>

  <!-- æˆ‘åŠ å…¥çš„æˆ¿é—´ -->
  <view class="my-room-section" wx:if="{{joinedRoom}}">
    <view class="section-title">æˆ‘åŠ å…¥çš„æˆ¿é—´</view>
    <view class="room-card card joined-room" bindtap="goJoinedRoom">
      <view class="room-header">
        <text class="room-name">{{joinedRoom.gameName}}</text>
        <text class="room-code">æˆ¿é—´å·: {{joinedRoom.roomCode}}</text>
      </view>
      <view class="room-info">
        <text class="member-count">{{joinedRoom.memberCount}}/{{joinedRoom.maxMembers}} äºº</text>
        <view class="room-status status-{{joinedRoom.status}}">{{joinedRoom.status === 'waiting' ? 'ç­‰å¾…ä¸­' : joinedRoom.status === 'divided' ? 'å·²åˆ†è¾¹' : 'å·²å…³é—­'}}</view>
      </view>
      <view class="room-owner">
        <text class="owner-label">æˆ¿ä¸»:</text>
        <text class="owner-name">{{joinedRoom.owner.nickname || 'æœªçŸ¥'}}</text>
      </view>
    </view>
  </view>

  <!-- åŠ å…¥æˆ¿é—´å¼¹çª— -->
  <view class="modal" wx:if="{{showJoinModal}}" bindtap="hideJoinDialog">
    <view class="modal-content" catchtap="preventClose">
      <view class="modal-title">åŠ å…¥æˆ¿é—´</view>
      <input
        class="input room-input"
        type="number"
        maxlength="6"
        placeholder="è¯·è¾“å…¥6ä½æˆ¿é—´å·"
        value="{{roomCode}}"
        bindinput="onRoomCodeInput"
      />
      <view class="modal-buttons">
        <button class="btn btn-secondary modal-btn" bindtap="hideJoinDialog">å–æ¶ˆ</button>
        <button class="btn btn-primary modal-btn" bindtap="handleJoinRoom">åŠ å…¥</button>
      </view>
    </view>
  </view>
</view>
